# 開發任務清單 (Development Tasks)

這份文件是給 Claude Code 使用的任務追蹤清單。每個任務都有明確的驗收標準。

---

## Phase 1：專案基礎建設 ⏳

### Task 1.1：初始化專案結構
**狀態**: 待開始  
**預估時間**: 1 小時

**目標**:
- [ ] 建立 monorepo 目錄結構
- [ ] 配置 pnpm workspace
- [ ] 設定 TypeScript 配置
- [ ] 設定 ESLint + Prettier

**驗收標準**:
- `pnpm install` 可以成功執行
- `pnpm dev` 可以同時啟動前後端

**指令**:
```bash
claude "根據 specs/DEPLOYMENT.md 的目錄結構，初始化整個專案"
```

---

### Task 1.2：後端基礎架構
**狀態**: 待開始  
**預估時間**: 2 小時

**目標**:
- [ ] 設定 Express 應用程式
- [ ] 配置 MongoDB 連線（Mongoose）
- [ ] 設定 CORS、Helmet 等中間件
- [ ] 建立錯誤處理中間件
- [ ] 建立基本健康檢查 API

**驗收標準**:
- `GET /api/v1/health` 回傳 `{ status: 'ok' }`
- 可以成功連接本地 MongoDB

**指令**:
```bash
claude "建立 Express 後端基礎架構，參考 specs/API_SPEC.md 的回應格式"
```

---

### Task 1.3：前端基礎架構
**狀態**: 待開始  
**預估時間**: 2 小時

**目標**:
- [ ] 設定 Vite + React
- [ ] 配置 Tailwind CSS
- [ ] 設定 React Router
- [ ] 建立基本 Layout 組件
- [ ] 設定 Axios 實例

**驗收標準**:
- 首頁可以正常顯示
- Tailwind 樣式正常運作

**指令**:
```bash
claude "建立 React 前端基礎架構，使用 Vite + Tailwind CSS"
```

---

## Phase 2：認證系統 ⏳

### Task 2.1：使用者 Model 與認證 API
**狀態**: 待開始  
**預估時間**: 3 小時

**目標**:
- [ ] 建立 User Model（參考 specs/DATA_MODELS.md）
- [ ] 實作註冊 API（POST /auth/register）
- [ ] 實作登入 API（POST /auth/login）
- [ ] 實作 JWT 驗證中間件
- [ ] 實作取得當前使用者 API（GET /auth/me）

**驗收標準**:
- 可以註冊新帳號
- 可以登入並獲得 JWT
- 帶 Token 可以取得使用者資訊

**指令**:
```bash
claude "實作使用者認證系統，包含註冊、登入、JWT 驗證，參考 specs/API_SPEC.md"
```

---

### Task 2.2：前端登入/註冊頁面
**狀態**: 待開始  
**預估時間**: 2 小時

**目標**:
- [ ] 建立登入頁面組件
- [ ] 建立註冊頁面組件
- [ ] 實作 useUserStore（Zustand）
- [ ] 實作 Token 儲存與自動驗證
- [ ] 實作路由保護（需登入才能訪問的頁面）

**驗收標準**:
- 可以在前端完成登入/註冊
- 登入後可以導向學生/教師儀表板
- 重新整理頁面後仍保持登入狀態

---

## Phase 3：題目系統 ⏳

### Task 3.1：題目與分類 Model
**狀態**: 待開始  
**預估時間**: 2 小時

**目標**:
- [ ] 建立 Question Model
- [ ] 建立 Category Model
- [ ] 建立種子資料腳本（seed）

**指令**:
```bash
claude "建立題目和分類的 Mongoose Model，並建立種子資料"
```

---

### Task 3.2：題目 CRUD API（教師用）
**狀態**: 待開始  
**預估時間**: 3 小時

**目標**:
- [ ] GET /questions（列表 + 篩選 + 分頁）
- [ ] GET /questions/:id
- [ ] POST /questions（需要 teacher 角色）
- [ ] PUT /questions/:id
- [ ] DELETE /questions/:id（軟刪除）

---

### Task 3.3：題目編輯器前端
**狀態**: 待開始  
**預估時間**: 4 小時

**目標**:
- [ ] 建立 QuestionEditor 組件
- [ ] 支援 Markdown 編輯
- [ ] 選項拖曳排序
- [ ] 圖片上傳
- [ ] 預覽功能

---

## Phase 4：答題與獎勵系統 ⏳

### Task 4.1：答題 API
**狀態**: 待開始  
**預估時間**: 3 小時

**目標**:
- [ ] 建立 Attempt Model
- [ ] GET /questions/random（取得隨機題目）
- [ ] POST /attempts（提交答案 + 計算獎勵）
- [ ] 實作獎勵計算邏輯（參考 specs/GAME_LOGIC.md）
- [ ] 更新使用者經驗值與金幣

---

### Task 4.2：戰鬥畫面前端
**狀態**: 待開始  
**預估時間**: 4 小時

**目標**:
- [ ] 建立 BattleScene 組件
- [ ] 計時器功能
- [ ] 選項選擇動畫
- [ ] 建立 BattleResult 組件
- [ ] 獎勵動畫效果

---

### Task 4.3：學生狀態列
**狀態**: 待開始  
**預估時間**: 2 小時

**目標**:
- [ ] 建立 StatusBar 組件
- [ ] 經驗條動畫
- [ ] 升級提示動畫

---

## Phase 5：商店與道具系統 ⏳

### Task 5.1：道具系統 API
**狀態**: 待開始  
**預估時間**: 3 小時

**目標**:
- [ ] 建立 Item Model
- [ ] 建立 Inventory Model
- [ ] GET /shop/items
- [ ] POST /shop/purchase
- [ ] 建立道具種子資料

---

### Task 5.2：商店前端
**狀態**: 待開始  
**預估時間**: 3 小時

**目標**:
- [ ] 建立商店頁面
- [ ] ShopItemCard 組件（稀有度樣式）
- [ ] 購買確認 Modal
- [ ] 購買成功動畫

---

### Task 5.3：角色裝扮系統
**狀態**: 待開始  
**預估時間**: 4 小時

**目標**:
- [ ] 建立 Avatar Model
- [ ] 裝備 API（PUT /avatar/equip）
- [ ] AvatarPreview 組件（圖層疊加）
- [ ] 道具庫頁面

---

## Phase 6：教師後台 ⏳

### Task 6.1：班級管理
**狀態**: 待開始  
**預估時間**: 3 小時

**目標**:
- [ ] 建立 Class Model
- [ ] 班級 CRUD API
- [ ] 班級加入代碼功能
- [ ] 學生加入班級功能

---

### Task 6.2：數據統計 API
**狀態**: 待開始  
**預估時間**: 4 小時

**目標**:
- [ ] GET /classes/:id/stats
- [ ] GET /students/:id/stats
- [ ] 各科目正確率計算
- [ ] 弱點分析邏輯

---

### Task 6.3：教師儀表板前端
**狀態**: 待開始  
**預估時間**: 4 小時

**目標**:
- [ ] 統計卡片組件
- [ ] 班級趨勢圖表（Recharts）
- [ ] 學生列表表格
- [ ] 需關注學生警示

---

### Task 6.4：報表輸出功能
**狀態**: 待開始  
**預估時間**: 4 小時

**目標**:
- [ ] 報表產生 API
- [ ] PDF 報表模板
- [ ] Excel 報表模板
- [ ] 報表下載功能

---

## Phase 7：遊戲化元素 ⏳

### Task 7.1：成就系統
**狀態**: 待開始  
**預估時間**: 3 小時

**目標**:
- [ ] 建立 Achievement Model
- [ ] 成就達成檢查邏輯
- [ ] 成就通知前端組件

---

### Task 7.2：冒險地圖
**狀態**: 待開始  
**預估時間**: 5 小時

**目標**:
- [ ] AdventureMap 組件
- [ ] 關卡節點互動
- [ ] 解鎖邏輯
- [ ] 地圖主題素材整合

---

### Task 7.3：排行榜
**狀態**: 待開始  
**預估時間**: 2 小時

**目標**:
- [ ] 排行榜 API
- [ ] 排行榜前端頁面
- [ ] 週排行結算邏輯

---

## Phase 8：紙娃娃角色系統 ⏳

### Task 8.1：角色部件資料模型
**狀態**: 待開始  
**預估時間**: 2 小時

**目標**:
- [ ] 建立 AvatarPart Model
- [ ] 建立 StudentAvatar Model
- [ ] 建立預設部件種子資料
- [ ] 部件 CRUD API

**參考**: specs/AVATAR_SYSTEM.md

---

### Task 8.2：角色渲染引擎
**狀態**: 待開始  
**預估時間**: 4 小時

**目標**:
- [ ] Canvas 圖層合成邏輯
- [ ] 顏色調整功能（膚色、髮色）
- [ ] 動畫支援（idle、walk）
- [ ] AvatarPreview 組件

---

### Task 8.3：角色編輯器 UI
**狀態**: 待開始  
**預估時間**: 5 小時

**目標**:
- [ ] 完整編輯器介面
- [ ] 部件分類瀏覽
- [ ] 顏色選擇器
- [ ] 即時預覽
- [ ] 儲存配置

---

### Task 8.4：教師素材上傳
**狀態**: 待開始  
**預估時間**: 3 小時

**目標**:
- [ ] 素材上傳 API
- [ ] 圖片驗證與處理
- [ ] 教師上傳介面
- [ ] 素材管理頁面

---

## Phase 9：地圖探索系統 ⏳

### Task 9.1：地圖資料結構
**狀態**: 待開始  
**預估時間**: 2 小時

**目標**:
- [ ] 建立 GameMap Model
- [ ] 建立 MapObject Model
- [ ] 建立 PlayerMapState Model
- [ ] 種子資料（數學森林地圖）

**參考**: specs/MAP_BATTLE_SYSTEM.md

---

### Task 9.2：地圖渲染引擎
**狀態**: 待開始  
**預估時間**: 5 小時

**目標**:
- [ ] Canvas 2D 地圖繪製
- [ ] 地磚系統
- [ ] 玩家角色顯示
- [ ] 怪物與物件顯示

---

### Task 9.3：移動與碰撞系統
**狀態**: 待開始  
**預估時間**: 3 小時

**目標**:
- [ ] 鍵盤控制（WASD/方向鍵）
- [ ] 觸控控制（虛擬搖桿）
- [ ] 碰撞檢測
- [ ] 視角跟隨（Camera Follow）
- [ ] 物件互動觸發

**參考**: specs/MAP_BATTLE_SYSTEM.md, specs/TABLET_TOUCH.md

---

### Task 9.4：怪物遭遇系統
**狀態**: 待開始  
**預估時間**: 2 小時

**目標**:
- [ ] 遭遇觸發邏輯
- [ ] 過場動畫
- [ ] 切換到戰鬥場景

---

## Phase 10：RPG 戰鬥系統 ⏳

### Task 10.1：戰鬥場景 UI
**狀態**: 待開始  
**預估時間**: 4 小時

**目標**:
- [ ] 戰鬥畫面佈局
- [ ] 玩家與怪物顯示
- [ ] 血條 UI
- [ ] 題目顯示區
- [ ] 選項/填空輸入

**參考**: specs/MAP_BATTLE_SYSTEM.md

---

### Task 10.2：戰鬥動畫系統
**狀態**: 待開始  
**預估時間**: 4 小時

**目標**:
- [ ] 攻擊動畫（Framer Motion）
- [ ] 受傷動畫
- [ ] 傷害數字飄出
- [ ] 勝利/失敗動畫

---

### Task 10.3：戰鬥邏輯整合
**狀態**: 待開始  
**預估時間**: 3 小時

**目標**:
- [ ] 答題 → 攻擊流程
- [ ] 怪物 HP 計算
- [ ] 獎勵結算
- [ ] 返回地圖

---

## Phase 11：UI 美化與觸控優化 ⏳

### Task 11.1：整合 RPGUI 樣式
**狀態**: 待開始  
**預估時間**: 2 小時

**目標**:
- [ ] 安裝並配置 RPGUI
- [ ] 覆蓋預設組件樣式
- [ ] 建立 GamePanel 組件
- [ ] 建立 GameButton 組件

**參考**: specs/UI_DESIGN.md

---

### Task 11.2：遊戲 UI 組件庫
**狀態**: 待開始  
**預估時間**: 4 小時

**目標**:
- [ ] 血條/經驗條組件
- [ ] 物品欄格子組件
- [ ] 對話框組件
- [ ] 稀有度發光效果

---

### Task 11.3：平板觸控控制
**狀態**: 待開始  
**預估時間**: 4 小時

**目標**:
- [ ] 虛擬搖桿組件
- [ ] 觸控友善按鈕尺寸（≥48px）
- [ ] 底部導航列
- [ ] 手勢操作（滑動切換）

**參考**: specs/TABLET_TOUCH.md

---

### Task 11.4：響應式佈局
**狀態**: 待開始  
**預估時間**: 3 小時

**目標**:
- [ ] 平板直向/橫向適配
- [ ] 桌面/平板導航切換
- [ ] 戰鬥畫面響應式
- [ ] 角色編輯器響應式

---

### Task 11.5：音效與震動回饋
**狀態**: 待開始  
**預估時間**: 2 小時

**目標**:
- [ ] 音效管理器
- [ ] 按鈕/答題音效
- [ ] 觸控震動回饋（Haptics）
- [ ] 音量控制設定

---

## Phase 12：部署與優化 ⏳

### Task 12.1：Zeabur 部署
**狀態**: 待開始  
**預估時間**: 2 小時

**目標**:
- [ ] 配置 zeabur.json
- [ ] 設定環境變數
- [ ] 部署測試

---

### Task 12.2：效能優化
**狀態**: 待開始  
**預估時間**: 3 小時

**目標**:
- [ ] API 響應快取
- [ ] 前端程式碼分割
- [ ] 圖片 lazy loading
- [ ] 資料庫索引優化

---

## 任務狀態圖例

- ⏳ 待開始
- 🔄 進行中
- ✅ 已完成
- ❌ 已取消
- 🔒 被阻擋（等待其他任務）

---

## Claude Code 使用建議

### 開始新任務時

```bash
claude "我要開始 Task 2.1，請先閱讀以下 spec 文件：
- specs/DATA_MODELS.md 中的 User model
- specs/API_SPEC.md 中的認證 API
然後開始實作"
```

### 繼續未完成任務

```bash
claude "繼續完成 Task 3.2，目前已完成 GET /questions，請繼續實作 POST"
```

### 除錯時

```bash
claude "Task 4.1 的 POST /attempts 有 bug，
錯誤訊息：[貼上錯誤]
請幫我修復"
```
